<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.1.1" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.1.1" type="image/png" sizes="32x32"><meta name="description" content="一        Linux基础优化       设置最大打开文件数 1）系统级的设置 # vi &#x2F;etc&#x2F;sysctl.conf 12345678910111213141516fs.file-max &#x3D; 262144net.ipv4.ip_local_port_range &#x3D; 1024 65000net.core.rmem_max &#x3D; 1677">
<meta property="og:type" content="article">
<meta property="og:title" content="tomcat安装部署">
<meta property="og:url" content="http://zhho.cn/2020/09/24/tomcat%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/index.html">
<meta property="og:site_name" content="Hao&#39;s blog">
<meta property="og:description" content="一        Linux基础优化       设置最大打开文件数 1）系统级的设置 # vi &#x2F;etc&#x2F;sysctl.conf 12345678910111213141516fs.file-max &#x3D; 262144net.ipv4.ip_local_port_range &#x3D; 1024 65000net.core.rmem_max &#x3D; 1677">
<meta property="og:locale">
<meta property="article:published_time" content="2020-09-24T06:06:50.000Z">
<meta property="article:modified_time" content="2020-09-25T02:45:47.893Z">
<meta property="article:author" content="Hao Zhang">
<meta name="twitter:card" content="summary"><title>tomcat安装部署 | Hao's blog</title><link ref="canonical" href="http://zhho.cn/2020/09/24/tomcat%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.1.1"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.1.1"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">Categories</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Hao's blog</div><div class="header-banner-info__subtitle">No pains ,no gains</div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">tomcat安装部署</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-09-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2020-09-25</span></span></div></header><div class="post-body">
        <h2 id="一-Linux基础优化"   >
          <a href="#一-Linux基础优化" class="heading-link"><i class="fas fa-link"></i></a>一        Linux基础优化</h2>
      <p>设置最大打开文件数</p>
<p>1）系统级的设置</p>
<p><code># vi /etc/sysctl.conf</code></p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">fs.file-max &#x3D; 262144</span><br><span class="line">net.ipv4.ip_local_port_range &#x3D; 1024 65000</span><br><span class="line">net.core.rmem_max &#x3D; 16777216</span><br><span class="line">net.core.wmem_max &#x3D; 16777216</span><br><span class="line">net.core.rmem_default &#x3D; 1048576</span><br><span class="line">net.core.wmem_default &#x3D; 524288</span><br><span class="line">net.ipv4.tcp_rmem &#x3D; 4096 87380 16777216</span><br><span class="line">net.ipv4.tcp_wmem &#x3D; 4096 65536 16777216</span><br><span class="line">net.core.netdev_max_backlog &#x3D; 2500</span><br><span class="line">net.ipv4.tcp_max_syn_backlog &#x3D; 8192</span><br><span class="line">net.ipv4.tcp_syncookies &#x3D; 1</span><br><span class="line">net.ipv4.tcp_tw_reuse &#x3D; 1</span><br><span class="line">net.ipv4.tcp_tw_recycle &#x3D; 0</span><br><span class="line">net.ipv4.tcp_fin_timeout &#x3D; 30</span><br><span class="line">net.nf_conntrack_max &#x3D; 655360</span><br><span class="line">net.netfilter.nf_conntrack_tcp_timeout_established &#x3D; 120</span><br></pre></td></tr></table></div></figure>

<p># 使其立即生效（centos 6系列可能报错，不用管）</p>
<p><code>#sysctl -p</code></p>
<p>2）用户级设置</p>
<p><code># sudo vi /etc/security/limits.conf</code></p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*           soft  nofile     65535</span><br><span class="line">*           hard  nofile     65535</span><br><span class="line">*           soft  nproc      65535</span><br><span class="line">*           hard  nproc      65535</span><br></pre></td></tr></table></div></figure>

<p>3）要使 limits.conf 文件配置生效，必须要确保 pam_limits.so 文件被加入到启动文件中。</p>
<p><code># vi /etc/pam.d/login</code></p>
<p>在最后一行添加:</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session required &#x2F;lib64&#x2F;security&#x2F;pam_limits.so</span><br></pre></td></tr></table></div></figure>

<a id="more"></a>




        <h2 id="二-JVM配置"   >
          <a href="#二-JVM配置" class="heading-link"><i class="fas fa-link"></i></a>二        JVM配置</h2>
      <p># df -h 查看系统最大分区，安装在此分区最佳</p>
<p># 上传jdk-7u79-linux-x64.gz到服务器</p>
<p><code># mkdir /opt/server</code></p>
<p><code># tar zvxf jdk-7u79-linux-x64.gz -C /opt/server</code></p>
<p><code># chmod 755 /opt -R</code></p>
<p>修改 /etc/profile</p>
<p><code># vi /etc/profile</code></p>
<p>——————在文件末尾添加以下内容——————</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME&#x3D;&#x2F;opt&#x2F;server&#x2F;jdk1.7.0_79（Java7）</span><br><span class="line">JAVA_HOME&#x3D;&#x2F;opt&#x2F;server&#x2F;jdk1.8.0_181（Java8）</span><br><span class="line">CLASSPATH&#x3D;$JAVA_HOME&#x2F;jre&#x2F;lib&#x2F;rt.jar:.</span><br><span class="line">PATH&#x3D;$JAVA_HOME&#x2F;bin:$PATH</span><br><span class="line">export JAVA_HOME PATH CLASSPATH</span><br></pre></td></tr></table></div></figure>

<p>——————结束————————————————</p>
<p><code># source /etc/profile</code></p>
<p># 检查java版本：</p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># java -version</span><br><span class="line">java version &quot;1.7.0_79&quot;</span><br><span class="line">Java(TM) SE Runtime Environment (build 1.7.0_79-b06)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 20.45-b01, mixed mode)</span><br></pre></td></tr></table></div></figure>




        <h2 id="三-Tomcat解压安装"   >
          <a href="#三-Tomcat解压安装" class="heading-link"><i class="fas fa-link"></i></a>三        Tomcat解压安装</h2>
      <p><code># tar zxvf apache-tomcat-8.0.53.tar.gz -C /opt/server/</code></p>
<p><code># chmod 755 -R /opt/</code></p>
<p><code># cd /opt/server</code></p>
<p><code># mv apache-tomcat-8.0.53 tomcat</code></p>
<p><code># cd /opt/server/tomcat/webapps/</code></p>
<p><code># rm -rf docs examples manager host-manager</code>   </p>

        <h3 id="四-日志切分"   >
          <a href="#四-日志切分" class="heading-link"><i class="fas fa-link"></i></a>四        日志切分</h3>
      <p># Tomcat日志配置</p>
<p>用root用户，安装cronolog</p>
<p># 上传cronolog-1.6.2-10.el6.x86_64.rpm 到 /opt/server</p>
<p><code># rpm -ivh cronolog-1.6.2-10.el6.x86_64.rpm</code></p>
<p># 用which命令查看路径验证安装</p>
<p><code># which cronolog</code></p>
<p><code>/usr/sbin/cronolog</code></p>
<p># 修改tomcat脚本</p>
<p><code># cd /opt/server</code></p>
<p><code># vim tomcat/bin/catalina.sh</code></p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"># touch &quot;$CATALINA_OUT&quot;</span><br><span class="line"></span><br><span class="line"> if [ &quot;$1&quot; &#x3D; &quot;-security&quot; ] ; then</span><br><span class="line"></span><br><span class="line">  if [ $have_tty -eq 1 ]; then</span><br><span class="line"></span><br><span class="line">   echo &quot;Using Security Manager&quot;</span><br><span class="line"></span><br><span class="line">  fi</span><br><span class="line"></span><br><span class="line">  shift</span><br><span class="line"></span><br><span class="line">  eval &quot;\&quot;$_RUNJAVA\&quot;&quot; &quot;\&quot;$LOGGING_CONFIG\&quot;&quot; $LOGGING_MANAGER $JAVA_OPTS $CATALINA_OPTS \</span><br><span class="line"></span><br><span class="line">   -Djava.endorsed.dirs&#x3D;&quot;\&quot;$JAVA_ENDORSED_DIRS\&quot;&quot; -classpath &quot;\&quot;$CLASSPATH\&quot;&quot; \</span><br><span class="line"></span><br><span class="line">   -Djava.security.manager \</span><br><span class="line"></span><br><span class="line">   -Djava.security.policy&#x3D;&#x3D;&quot;\&quot;$CATALINA_BASE&#x2F;conf&#x2F;catalina.policy\&quot;&quot; \</span><br><span class="line"></span><br><span class="line">   -Dcatalina.base&#x3D;&quot;\&quot;$CATALINA_BASE\&quot;&quot; \</span><br><span class="line"></span><br><span class="line">   -Dcatalina.home&#x3D;&quot;\&quot;$CATALINA_HOME\&quot;&quot; \</span><br><span class="line"></span><br><span class="line">   -Djava.io.tmpdir&#x3D;&quot;\&quot;$CATALINA_TMPDIR\&quot;&quot; \</span><br><span class="line"></span><br><span class="line">   org.apache.catalina.startup.Bootstrap &quot;$@&quot; start 2&gt;&amp;1 \</span><br><span class="line"></span><br><span class="line">   | &#x2F;usr&#x2F;sbin&#x2F;cronolog &quot;$CATALINA_BASE&quot;&#x2F;logs&#x2F;catalina.%Y-%m-%d.out &gt;&gt; &#x2F;dev&#x2F;null &amp;</span><br><span class="line"></span><br><span class="line">#   org.apache.catalina.startup.Bootstrap &quot;$@&quot; start \</span><br><span class="line"></span><br><span class="line">#   &gt;&gt; &quot;$CATALINA_OUT&quot; 2&gt;&amp;1 &quot;&amp;&quot;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> else</span><br><span class="line"></span><br><span class="line">  eval &quot;\&quot;$_RUNJAVA\&quot;&quot; &quot;\&quot;$LOGGING_CONFIG\&quot;&quot; $LOGGING_MANAGER $JAVA_OPTS $CATALINA_OPTS \</span><br><span class="line"></span><br><span class="line">   -Djava.endorsed.dirs&#x3D;&quot;\&quot;$JAVA_ENDORSED_DIRS\&quot;&quot; -classpath &quot;\&quot;$CLASSPATH\&quot;&quot; \</span><br><span class="line"></span><br><span class="line">   -Dcatalina.base&#x3D;&quot;\&quot;$CATALINA_BASE\&quot;&quot; \</span><br><span class="line"></span><br><span class="line">   -Dcatalina.home&#x3D;&quot;\&quot;$CATALINA_HOME\&quot;&quot; \</span><br><span class="line"></span><br><span class="line">   -Djava.io.tmpdir&#x3D;&quot;\&quot;$CATALINA_TMPDIR\&quot;&quot; \</span><br><span class="line"></span><br><span class="line">   org.apache.catalina.startup.Bootstrap &quot;$@&quot; start 2&gt;&amp;1 \</span><br><span class="line"></span><br><span class="line">   | &#x2F;usr&#x2F;sbin&#x2F;cronolog &quot;$CATALINA_BASE&quot;&#x2F;logs&#x2F;catalina.%Y-%m-%d.out &gt;&gt; &#x2F;dev&#x2F;null &amp;</span><br><span class="line"></span><br><span class="line">#   org.apache.catalina.startup.Bootstrap &quot;$@&quot; start \</span><br><span class="line"></span><br><span class="line">#   &gt;&gt; &quot;$CATALINA_OUT&quot; 2&gt;&amp;1 &quot;&amp;&quot;</span><br></pre></td></tr></table></div></figure>




        <h3 id="五-日志-参数乱码-app路径"   >
          <a href="#五-日志-参数乱码-app路径" class="heading-link"><i class="fas fa-link"></i></a>五        日志/参数乱码/app路径</h3>
      
        <h3 id="1）jvm-修改-注意每个环境路径不同"   >
          <a href="#1）jvm-修改-注意每个环境路径不同" class="heading-link"><i class="fas fa-link"></i></a>1）jvm 修改 (注意每个环境路径不同)</h3>
      <p>catalina.sh 文件里 JAVA_OPTS最终修改如下（如果没有，则添加下面内容在文件第一行）:</p>
<p><code>#vim tomcat/bin/catalina.sh</code></p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPTS&#x3D;&quot;$&#123;JAVA_OPTS&#125; -Duser.timezone&#x3D;Asia&#x2F;Shanghai -Dfile.encoding&#x3D;utf-8 -server -XX:PermSize&#x3D;512m -XX:MaxPermSize&#x3D;512m -Xms4096m -Xmx4096m -Djava.awt.headless&#x3D;true&quot;</span><br><span class="line"></span><br><span class="line">CATALINA_HOME&#x3D;&#x2F;opt&#x2F;server&#x2F;tomcat</span><br><span class="line"></span><br><span class="line">JAVA_HOME&#x3D;&#x2F;opt&#x2F;server&#x2F;jdk1.7.0_79</span><br></pre></td></tr></table></div></figure>




        <h3 id="2）线程数修改"   >
          <a href="#2）线程数修改" class="heading-link"><i class="fas fa-link"></i></a>2）线程数修改</h3>
      <p><code># vim tomcat/conf/server.xml</code></p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port&#x3D;&quot;8080&quot; protocol&#x3D;&quot;HTTP&#x2F;1.1&quot;</span><br><span class="line">connectionTimeout&#x3D;&quot;20000&quot;</span><br><span class="line">      redirectPort&#x3D;&quot;8443&quot;</span><br><span class="line">URIEncoding&#x3D;&quot;UTF-8&quot;</span><br><span class="line">maxThreads&#x3D;&quot;1000&quot;</span><br><span class="line">minSpareThreads&#x3D;&quot;200&quot;</span><br><span class="line">maxSpareThreads&#x3D;&quot;500&quot;</span><br><span class="line">      &#x2F;&gt;</span><br></pre></td></tr></table></div></figure>


        <h3 id="3）App路径修改"   >
          <a href="#3）App路径修改" class="heading-link"><i class="fas fa-link"></i></a>3）App路径修改</h3>
      <p><code># vim tomcat/conf/server.xml</code></p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name&#x3D;&quot;localhost&quot; appBase&#x3D;&quot;&#x2F;opt&#x2F;apps&quot;</span><br><span class="line">			unpackWARs&#x3D;&quot;true&quot; autoDeploy&#x3D;&quot;true&quot; reloadable&#x3D;&quot;true&quot;&gt;</span><br></pre></td></tr></table></div></figure>

<p><code># mkdir /opt/apps</code></p>
<p><code># chmod 755 -R /opt/apps</code></p>

        <h3 id="六-清理日志脚本"   >
          <a href="#六-清理日志脚本" class="heading-link"><i class="fas fa-link"></i></a>六        清理日志脚本</h3>
      <p>每天早上1点清理tomcat日志</p>
<p><code># mkdir /opt/server/scripts</code></p>
<p><code># chmod 755 -R /opt/server/scripts</code></p>
<p><code># vim /opt/server/scripts/clear_tomcat_logs.sh</code></p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"># clear tomcat logs</span><br><span class="line">KEEP_TIME&#x3D;30</span><br><span class="line">DOMAIN_HOME&#x3D;&quot;&#x2F;opt&#x2F;server&#x2F;tomcat&quot;</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;find $DOMAIN_HOME&#x2F;logs -mtime +$KEEP_TIME -exec rm -rf &#123;&#125; \; &gt;&gt;&#x2F;tmp&#x2F;clean_tomcat_logs.log</span><br><span class="line">exit 0</span><br></pre></td></tr></table></div></figure>

<p><code># chmod +x /opt/server/scripts/clear_tomcat_logs.sh</code></p>
<p><code># crontab -e</code></p>
<p> <code>0 1 * * * sh /opt/server/scripts/clear_tomcat_logs.sh</code></p>

        <h2 id="七-tomcat系统服务脚本"   >
          <a href="#七-tomcat系统服务脚本" class="heading-link"><i class="fas fa-link"></i></a>七        tomcat系统服务脚本</h2>
      <p><code># touch /etc/init.d/tomcat</code></p>
<p><code># vim /etc/init.d/tomcat</code></p>
<figure class="highlight plain"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;sh</span><br><span class="line">#tomcat: Start&#x2F;Stop&#x2F;Restart tomcat</span><br><span class="line">#chkconfig: 2345 40 20</span><br><span class="line">#description: Tomcat is a Java Servlet Container</span><br><span class="line">#match these values to your environment:</span><br><span class="line">TOMCAT_HOME&#x3D;&#x2F;opt&#x2F;server&#x2F;tomcat-59001</span><br><span class="line">TOMCAT_USER&#x3D;dzfp</span><br><span class="line">NOW_USER&#x3D;$(whoami)</span><br><span class="line">. &#x2F;etc&#x2F;init.d&#x2F;functions TOMCAT&#x3D;$&#123;TOMCAT_HOME&#125;</span><br><span class="line"></span><br><span class="line">start() &#123;</span><br><span class="line">	echo -n &quot;Starting Tomcat:&quot;</span><br><span class="line">	if [ &quot;$NOW_USER&quot; &#x3D;&#x3D; &quot;dzfp&quot; ];then</span><br><span class="line">		$&#123;TOMCAT_HOME&#125;&#x2F;bin&#x2F;startup.sh</span><br><span class="line">	else</span><br><span class="line">		su  - $&#123;TOMCAT_USER&#125;  -c  &quot;$&#123;TOMCAT_HOME&#125;&#x2F;bin&#x2F;startup.sh&quot;</span><br><span class="line">	fi</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">stop() &#123;</span><br><span class="line">	echo -n &quot;Stopping Tomcat:&quot;</span><br><span class="line">	if [ &quot;$NOW_USER&quot; &#x3D;&#x3D; &quot;dzfp&quot; ];then</span><br><span class="line">		$&#123;TOMCAT_HOME&#125;&#x2F;bin&#x2F;shutdown.sh</span><br><span class="line">	else</span><br><span class="line">		su  - $&#123;TOMCAT_USER&#125; -c &quot;$&#123;TOMCAT_HOME&#125;&#x2F;bin&#x2F;shutdown.sh&quot;</span><br><span class="line">	fi</span><br><span class="line"># clear tomcat cache</span><br><span class="line">    rm -rf $TOMCAT_HOME&#x2F;work&#x2F;Catalina</span><br><span class="line">   &#125;</span><br><span class="line"># See how we were called.</span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">  start)</span><br><span class="line">      start</span><br><span class="line">  ;;</span><br><span class="line">    stop)</span><br><span class="line">        stop</span><br><span class="line">    ;;</span><br><span class="line"> status)</span><br><span class="line">    ;;</span><br><span class="line">    restart)</span><br><span class="line">       stop</span><br><span class="line">sleep 2</span><br><span class="line">       start</span><br><span class="line">    ;;</span><br><span class="line"> *)</span><br><span class="line">echo &quot;Usage: $0 &#123;start stop restart&#125;&quot; ;;</span><br><span class="line">esac</span><br><span class="line">exit $RETVAL</span><br></pre></td></tr></table></div></figure>

<p>设置开机自启</p>
<p><code># chkconfig tomcat --add</code></p>
<p><strong>至此，tomcat部署完成！</strong></p>
<h6 id=""><a href="#" class="headerlink" title=""></a></h6></div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="http://zhho.cn">Hao Zhang</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="http://zhho.cn/2020/09/24/tomcat%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/">http://zhho.cn/2020/09/24/tomcat%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2020/09/24/k8s-network-cilium/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">k8s-network-cilium 搭建kubernetes集群</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2020/09/24/mysql%E6%85%A2%E6%97%A5%E5%BF%97%E5%88%87%E5%89%B2/"><span class="paginator-prev__text">mysql慢日志切割</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-Linux%E5%9F%BA%E7%A1%80%E4%BC%98%E5%8C%96"><span class="toc-number">1.</span> <span class="toc-text">
          一        Linux基础优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-JVM%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">
          二        JVM配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-Tomcat%E8%A7%A3%E5%8E%8B%E5%AE%89%E8%A3%85"><span class="toc-number">3.</span> <span class="toc-text">
          三        Tomcat解压安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B-%E6%97%A5%E5%BF%97%E5%88%87%E5%88%86"><span class="toc-number">3.1.</span> <span class="toc-text">
          四        日志切分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94-%E6%97%A5%E5%BF%97-%E5%8F%82%E6%95%B0%E4%B9%B1%E7%A0%81-app%E8%B7%AF%E5%BE%84"><span class="toc-number">3.2.</span> <span class="toc-text">
          五        日志&#x2F;参数乱码&#x2F;app路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89jvm-%E4%BF%AE%E6%94%B9-%E6%B3%A8%E6%84%8F%E6%AF%8F%E4%B8%AA%E7%8E%AF%E5%A2%83%E8%B7%AF%E5%BE%84%E4%B8%8D%E5%90%8C"><span class="toc-number">3.3.</span> <span class="toc-text">
          1）jvm 修改 (注意每个环境路径不同)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89%E7%BA%BF%E7%A8%8B%E6%95%B0%E4%BF%AE%E6%94%B9"><span class="toc-number">3.4.</span> <span class="toc-text">
          2）线程数修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%89App%E8%B7%AF%E5%BE%84%E4%BF%AE%E6%94%B9"><span class="toc-number">3.5.</span> <span class="toc-text">
          3）App路径修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD-%E6%B8%85%E7%90%86%E6%97%A5%E5%BF%97%E8%84%9A%E6%9C%AC"><span class="toc-number">3.6.</span> <span class="toc-text">
          六        清理日志脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-tomcat%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E8%84%9A%E6%9C%AC"><span class="toc-number">4.</span> <span class="toc-text">
          七        tomcat系统服务脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">4.0.0.0.1.</span> <span class="toc-text"></span></a></li></ol></li></ol></li></ol></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">Meteor across</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">31</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">0</div><div class="sidebar-ov-state-item__name">Categories</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">3</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2021</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Hao Zhang</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v5.1.1</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.1.1</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.1.1"></script><script src="/js/stun-boot.js?v=2.1.1"></script><script src="/js/scroll.js?v=2.1.1"></script><script src="/js/header.js?v=2.1.1"></script><script src="/js/sidebar.js?v=2.1.1"></script></body></html>